angular.module("sortHeader",[]).constant("sortHeaderConsts",{cssHeader:"sort-header",cssProp:"sort-property",ascClass:"sort-asc",descClass:"sort-desc",asc:"asc",desc:"desc"}).factory("sortHeaderTools",["sortHeaderConsts",function(s){return{getOrderingClass:function(r){switch(r){case s.asc:return s.ascClass;case s.desc:return s.descClass;default:return""}}}}]).directive("sort",["$q","sortHeaderConsts",function(s,r){return{restrict:"A",scope:{sort:"=",sortRefresh:"&",query:"@"},controller:["$scope",function(e){this.active="",this.sort=function(t,o,a,c){return e.query?s.when(e.sortRefresh().call(this,t,o,a?a.replace(/\s/g,""):a,c)):(null===a||void 0===a?e.sort.sort(function(s,e){return c?o===r.asc?c.indexOf(s[t])-c.indexOf(e[t]):c.indexOf(e[t])-c.indexOf(s[t]):s[t]>e[t]?o===r.asc?1:-1:s[t]<e[t]&&o===r.asc?-1:0}):"date"===a.replace(/\s/g,"")&&e.sort.sort(function(s,e){var a=new Date(e[t]).getTime()-new Date(s[t]).getTime();return o===r.asc?-a:a}),s.when(0))}}],controllerAs:"sortCtrl",link:function(s,e,t){angular.element(e).addClass(r.cssHeader),s.query=!!t.sortRefresh}}}]).directive("sortProperty",["sortHeaderConsts","sortHeaderTools",function(s,r){return{restrict:"A",require:"^sort",scope:{sortOrder:"@",sortPreset:"=?"},link:function(e,t,o,a){e.sortOrder=e.sortOrder||s.asc;var c=angular.element(t),n=o.sortProperty.split("|");e.$watch(function(){return a.active},function(r){r!=n[0]&&c.removeClass(s.ascClass+" "+s.descClass)}),c.addClass(s.cssProp),c.on("click",function(){a.active=n[0],a.sort(n[0].replace(/\s/g,""),e.sortOrder,n[1],e.sortPreset).then(function(){c.removeClass(s.ascClass+" "+s.descClass).addClass(r.getOrderingClass(e.sortOrder)),e.sortOrder=e.sortOrder===s.asc?s.desc:s.asc})}),o.sortDefault&&c.triggerHandler("click")}}}]);